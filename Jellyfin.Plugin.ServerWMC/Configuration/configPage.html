<!DOCTYPE html>
<html>
<head>
    <title>ServerWMC</title>
</head>
<body>
    <div id="ServerWMCConfigurationPage" data-role="page" class="page type-interior pluginConfigurationPage" data-require="emby-input,emby-button">
        <div data-role="content">
            <div class="content-primary">
                <form class="serverwmcConfigurationForm">

                <form id="ServerWMCConfigurationForm">
                            </div>
                        </li>
                        <li>
                            <label for="txtServerWMCPort">
                                ServerWMC Port:
                            </label>
                            <input id="txtServerWMCPort" name="txtServerWMCPort" type="number" pattern="[0-9]*" min="1" />
                            <div class="fieldDescription">
                                The Port of your ServerWMC machine
                            </div>
                        </li>
                        <li>
                            <label for="txtLinux">
                                Linux 'Recorded TV' path:
                            </label>
                            <input type="text" id="txtLinuxPath" name="txtLinuxPath" />
                            <div class="fieldDescription">
                                For Emby running on Linux, WMC's 'recorded tv' share needs to be mounted and the linux path to this directory needs to be entered here.
                            </div>
                        </li>
                        <li>
                            <button type="submit" data-theme="b">Save</button>
                            <button type="button" onclick="history.back();">Cancel</button>
                        </li>
                    </ul>

                </form>
            </div>
        </div>

        <script type="text/javascript">
            var ServerWMCConfig = {
                pluginUniqueId: '1fc322a1-af2e-49a5-b2eb-a89b4240f700'
            };
            $('#ServerWMCConfigurationPage').on('pageshow', function () {
                ApiClient.getPluginConfiguration(ServerWMCConfig.pluginUniqueId).then(function (config) {
                    var page = $.mobile.activePage;
                    $('#txtServerWMCIP', page).val(config.ServerIP).change();
                    $('#txtServerWMCPort', page).val(config.ServerPort).change();
                    $('#txtLinuxPath', page).val(config.LinuxPath).change();
                });
            });
            $('#ServerWMCConfigurationForm').on('submit', function () {
                ApiClient.getPluginConfiguration(ServerWMCConfig.pluginUniqueId).then(function (config) {
                    var page = $.mobile.activePage;
                    config.ServerIP = $('#txtServerWMCIP', page).val();
                    config.ServerPort = $('#txtServerWMCPort', page).val();
                    config.LinuxPath = $('#txtLinuxPath', page).val();
                    ApiClient.updatePluginConfiguration(ServerWMCConfig.pluginUniqueId, config).then(function (result) {
                        Dashboard.processPluginConfigurationUpdateResult(result);
                    },
                    function (result) {
                        Dashboard.alert("Saving configuration failed.");
                        });
                });

                return false;
            });
        </script>
    </div>
</body>
</html>